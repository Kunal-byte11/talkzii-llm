(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{283:(e,t,r)=>{"use strict";r.d(t,{A:()=>d,AuthProvider:()=>l});var s=r(5155),o=r(2115),a=r(2643),n=r(5695);let i=o.createContext(void 0),l=e=>{let{children:t}=e,[r,l]=o.useState(null),[d,u]=o.useState(null),[c,f]=o.useState(null),[m,p]=o.useState(!0),[g,h]=o.useState(!0),v=(0,n.useRouter)(),b=(0,n.usePathname)();(0,o.useEffect)(()=>{(async()=>{p(!0),h(!0);try{let{data:{session:t},error:r}=await a.N.auth.getSession();if(r)console.error("Error fetching initial session:",r.message),(r.message.includes("Invalid Refresh Token")||r.message.includes("Refresh Token Not Found")||r.message.includes("invalid_grant"))&&(console.warn("Invalid token detected during initial session fetch, attempting to sign out to clear state."),await a.N.auth.signOut()),u(null),l(null),f(null);else{var e;u(t);let r=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null;if(l(r),r){let{data:e,error:t}=await a.N.from("profiles").select("*").eq("id",r.id).single();t&&"PGRST116"!==t.code&&console.error("Initial profile fetch error:",t),f(e)}else f(null)}}catch(e){console.error("Critical error during initial data fetch (AuthProvider):",e.message,e),u(null),l(null),f(null)}finally{p(!1),h(!1)}})();let{data:e}=a.N.auth.onAuthStateChange(async(e,t)=>{var s;console.log("Auth State Change Event:",e,t),p(!0),u(t);let o=null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null,n=null==r?void 0:r.id;if(l(o),"SIGNED_OUT"===e){if(console.log("User signed out. Clearing profile."),n)try{localStorage.removeItem("talkzi_chat_history_".concat(n)),localStorage.removeItem("talkzi_ai_friend_type_".concat(n)),localStorage.removeItem("talkzii_chat_memory_".concat(n)),localStorage.removeItem("talkzii_memory_warning_shown_".concat(n))}catch(e){console.error("Error clearing user-specific localStorage on sign out",e)}f(null),h(!1),p(!1);return}if(o){h(!0);let{data:e,error:t}=await a.N.from("profiles").select("*").eq("id",o.id).single();t&&"PGRST116"!==t.code&&console.error("Error fetching profile on auth change:",t),f(e),h(!1)}else f(null),h(!1);p(!1)});return()=>{null==e||e.subscription.unsubscribe()}},[]),(0,o.useEffect)(()=>{if(m)return;let e="/auth"===b;d&&e&&v.push("/aipersona")},[d,b,v,m]);let x=async()=>{let{error:e}=await a.N.auth.signOut();e&&console.error("Error signing out: ",e)},y=m||!!r&&g,w=(0,o.useMemo)(()=>({user:r,session:d,profile:c,isLoading:y,signOut:x}),[r,d,c,y]);return(0,s.jsx)(i.Provider,{value:w,children:t})},d=()=>{let e=o.useContext(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider. Check your component tree and ensure AuthProvider is an ancestor, especially in layout.tsx or equivalent files. If this error persists after confirming the provider setup, try deleting your .next folder and restarting the dev server to clear potential caching issues.");return e}},285:(e,t,r)=>{"use strict";r.d(t,{$:()=>d,r:()=>l});var s=r(5155),o=r(2115),a=r(9708),n=r(2085),i=r(9434);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=o.forwardRef((e,t)=>{let{className:r,variant:o,size:n,asChild:d=!1,...u}=e,c=d?a.DX:"button";return(0,s.jsx)(c,{className:(0,i.cn)(l({variant:o,size:n,className:r})),ref:t,...u})});d.displayName="Button"},347:()=>{},2178:(e,t,r)=>{"use strict";r.d(t,{CookieConsentBanner:()=>d});var s=r(5155),o=r(2115),a=r(285),n=r(9434),i=r(2400);let l="talkzii_cookie_consent_given";function d(){let[e,t]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{try{let e=localStorage.getItem(l);"true"!==e&&t(!0)}catch(e){console.warn("Could not read cookie consent status from localStorage:",e),t(!0)}},[]),e)?(0,s.jsx)("div",{className:(0,n.cn)("fixed bottom-0 left-0 right-0 z-[9999] p-4 md:p-6 print:hidden","bg-background/90 border-t border-border shadow-lg backdrop-blur-sm","transition-transform duration-300 ease-out",e?"translate-y-0":"translate-y-full"),role:"dialog","aria-live":"polite","aria-label":"Cookie consent","aria-describedby":"cookie-consent-description",children:(0,s.jsxs)("div",{className:"container mx-auto flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-start sm:items-center gap-3",children:[(0,s.jsx)(i.A,{className:"h-8 w-8 sm:h-7 sm:w-7 text-primary flex-shrink-0 mt-1 sm:mt-0"}),(0,s.jsx)("p",{id:"cookie-consent-description",className:"text-sm text-foreground",children:"We use cookies to enhance your experience, remember your preferences, and ensure our app functions smoothly. By continuing to use Talkzii, you agree to our use of cookies."})]}),(0,s.jsx)(a.$,{onClick:()=>{try{localStorage.setItem(l,"true"),t(!1)}catch(e){console.error("Could not save cookie consent status to localStorage:",e),t(!1)}},className:"gradient-button w-full sm:w-auto px-6 py-2.5 text-sm font-semibold rounded-lg shadow-md hover:shadow-lg transition-shadow whitespace-nowrap","aria-label":"Accept cookies",children:"Got it, thanks!"})]})}):null}},2558:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>v});var s=r(5155),o=r(7481),a=r(2115),n=r(3057),i=r(2085),l=r(5318),d=r(9434);let u=n.Kq,c=a.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,s.jsx)(n.LM,{ref:t,className:(0,d.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...o})});c.displayName=n.LM.displayName;let f=(0,i.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),m=a.forwardRef((e,t)=>{let{className:r,variant:o,...a}=e;return(0,s.jsx)(n.bL,{ref:t,className:(0,d.cn)(f({variant:o}),r),...a})});m.displayName=n.bL.displayName,a.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,s.jsx)(n.rc,{ref:t,className:(0,d.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r),...o})}).displayName=n.rc.displayName;let p=a.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,s.jsx)(n.bm,{ref:t,className:(0,d.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...o,children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})});p.displayName=n.bm.displayName;let g=a.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,s.jsx)(n.hE,{ref:t,className:(0,d.cn)("text-sm font-semibold",r),...o})});g.displayName=n.hE.displayName;let h=a.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,s.jsx)(n.VY,{ref:t,className:(0,d.cn)("text-sm opacity-90",r),...o})});function v(){let{toasts:e}=(0,o.dj)();return(0,s.jsxs)(u,{children:[e.map(function(e){let{id:t,title:r,description:o,action:a,...n}=e;return(0,s.jsxs)(m,{...n,children:[(0,s.jsxs)("div",{className:"grid gap-1",children:[r&&(0,s.jsx)(g,{children:r}),o&&(0,s.jsx)(h,{children:o})]}),a,(0,s.jsx)(p,{})]},t)}),(0,s.jsx)(c,{})]})}h.displayName=n.VY.displayName},2643:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});let s=(0,r(851).UU)("https://your-supabase-url.supabase.co","your-supabase-anon-key",{auth:{persistSession:!0,autoRefreshToken:!0}})},5852:(e,t,r)=>{Promise.resolve().then(r.bind(r,1828)),Promise.resolve().then(r.bind(r,8031)),Promise.resolve().then(r.t.bind(r,6397,23)),Promise.resolve().then(r.t.bind(r,1264,23)),Promise.resolve().then(r.t.bind(r,8489,23)),Promise.resolve().then(r.t.bind(r,689,23)),Promise.resolve().then(r.t.bind(r,8723,23)),Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,2178)),Promise.resolve().then(r.bind(r,2558)),Promise.resolve().then(r.bind(r,283))},7481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>f});var s=r(2115);let o=0,a=new Map,n=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),u({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?n(r):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function u(e){d=i(d,e),l.forEach(e=>{e(d)})}function c(e){let{...t}=e,r=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>u({type:"DISMISS_TOAST",toastId:r});return u({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>u({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=s.useState(d);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>u({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>a});var s=r(2596),o=r(9688);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[1565,7690,4277,6629,4908,1590,8441,1684,7358],()=>t(5852)),_N_E=e.O()}]);