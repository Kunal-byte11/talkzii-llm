(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9347],{385:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(5155),i=r(2115),o=r(3264),s=r(7431),a=r(5695);let c=()=>{let e=(0,i.useRef)(null),t=(0,i.useRef)(null),r=(0,i.useRef)(null),[c,h]=(0,i.useState)("Initializing..."),[l,u]=(0,i.useState)(""),[d,p]=(0,i.useState)(!1),g=(0,a.useRouter)();(0,i.useEffect)(()=>{if(!("SpeechRecognition"in window||"webkitSpeechRecognition"in window)){h("Speech recognition is not supported in your browser. Please use Chrome, Edge, or Safari.");return}if(!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)){h("Microphone access is not supported in your browser.");return}navigator.mediaDevices.getUserMedia({audio:!0}).then(()=>{h("Listening...")}).catch(e=>{console.error("Microphone permission error:",e),h("Please allow microphone access to use speech recognition.")})},[]);class m{init(){if(!this.container)return;this.scene=new o.Z58,this.scene.background=new o.Q1f(657930),this.camera=new o.ubm(75,this.container.clientWidth/this.container.clientHeight,.1,1e3),this.camera.position.z=5,this.renderer=new s.JeP({antialias:!0,alpha:!0}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setClearColor(657930,1),this.container.appendChild(this.renderer.domElement);let e=new o.$p8(4210752,.3);this.scene.add(e);let t=new o.ZyN(0xffffff,.8);t.position.set(10,10,5),this.scene.add(t),this.createSphereVisualization()}createSphereVisualization(){let e=new o.Gu$(1,64,32),t=new o.tXL({color:65430,wireframe:!0,transparent:!0,opacity:.8}),r=new o.eaF(e,t);this.scene.add(r),this.visualObjects.push(r);let n=new o.Gu$(.8,32,16),i=new o.V9B({color:65430,transparent:!0,opacity:.3}),s=new o.eaF(n,i);this.scene.add(s),this.visualObjects.push(s)}updateVisualization(){this.visualObjects.forEach((e,t)=>{0===t&&e.material&&(e.rotation.y+=.01)})}render(){this.renderer&&this.scene&&this.camera&&(this.currentRotationX+=(this.targetRotationX-this.currentRotationX)*.05,this.currentRotationY+=(this.targetRotationY-this.currentRotationY)*.05,this.scene.rotation.x=this.currentRotationY,this.scene.rotation.y=this.currentRotationX,this.updateVisualization(),this.renderer.render(this.scene,this.camera))}handleResize(){this.container&&this.camera&&this.renderer&&(this.camera.aspect=this.container.clientWidth/this.container.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight))}dispose(){this.visualObjects.forEach(e=>{e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}),this.renderer&&(this.renderer.dispose(),this.container&&this.renderer.domElement&&this.container.removeChild(this.renderer.domElement))}constructor(e){this.container=e,this.scene=null,this.camera=null,this.renderer=null,this.visualObjects=[],this.mouseX=0,this.mouseY=0,this.targetRotationX=0,this.targetRotationY=0,this.currentRotationX=0,this.currentRotationY=0,this.init()}}let w=()=>{t.current&&t.current.render&&t.current.render(),r.current=requestAnimationFrame(w)};return(0,i.useEffect)(()=>{if(e.current&&!t.current)try{t.current=new m(e.current),w()}catch(e){h("Failed to initialize 3D scene")}return()=>{r.current&&cancelAnimationFrame(r.current),t.current&&(t.current.dispose(),t.current=null)}},[]),(0,i.useEffect)(()=>{let e=()=>{t.current&&t.current.handleResize&&t.current.handleResize()};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{let e=null,t=!1;return(async()=>{try{let r=window.SpeechRecognition||window.webkitSpeechRecognition;if(!r)throw Error("Speech recognition is not supported in your browser.");(e=new r).continuous=!1,e.interimResults=!1,e.lang="en-US",e.onstart=()=>{console.log("Speech recognition started"),h("Listening...")},e.onresult=async e=>{let t=Array.from(e.results).map(e=>e[0].transcript).join("");if(console.log("Speech result:",t,e),!t.trim()){h("No speech detected, please try again."),p(!1);return}u(t),h("Thinking..."),p(!0);try{let e=await fetch("/api/speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})});if(!e.ok){let t=await e.text();console.error("API error:",t),h("API error: "+t),p(!1);return}let r=await e.blob();h("Speaking...");let n=URL.createObjectURL(r),i=new Audio(n);i.onended=()=>{h("Done"),p(!1),URL.revokeObjectURL(n),setTimeout(()=>g.push("/"),1e3)},i.onerror=e=>{console.error("Audio playback error:",e),h("Error playing audio"),p(!1),URL.revokeObjectURL(n)},await i.play()}catch(e){console.error("Network or server error:",e),h("Network or server error"),p(!1)}},e.onerror=e=>{console.error("Speech recognition error:",{error:e.error,message:e.message,type:e.type});let t="Speech recognition error";switch(e.error){case"no-speech":t="No speech was detected. Please try again.";break;case"aborted":t="Speech recognition was aborted.";break;case"audio-capture":t="No microphone was found. Please ensure your microphone is connected and permitted.";break;case"network":t="Network error occurred. Please check your internet connection.";break;case"not-allowed":t="Microphone access was denied. Please allow microphone access in your browser settings.";break;case"service-not-allowed":t="Speech recognition service is not allowed.";break;case"bad-grammar":t="Speech recognition grammar error.";break;case"language-not-supported":t="Language not supported. Please try using English.";break;default:t="Speech recognition error: ".concat(e.error)}h(t),p(!1)},e.onend=()=>{console.log("Speech recognition ended"),t||d||h("No speech detected, please try again.")};try{e.start()}catch(e){console.error("Error starting recognition:",e),h("Failed to start speech recognition")}}catch(e){console.error("Speech recognition initialization error:",e),h(e instanceof Error?e.message:"Failed to initialize speech recognition")}})(),()=>{if(t=!0,e)try{e.stop()}catch(e){console.error("Error stopping recognition:",e)}}},[]),(0,n.jsxs)("div",{className:"relative w-full h-screen bg-black overflow-hidden",children:[(0,n.jsx)("div",{ref:e,className:"w-full h-full"}),(0,n.jsx)("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-10 text-white text-lg font-semibold bg-black/60 px-6 py-2 rounded-xl shadow",children:c}),l&&(0,n.jsxs)("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-10 text-white text-xl font-bold bg-black/70 px-6 py-3 rounded-xl shadow",children:['"',l,'"']})]})}},5695:(e,t,r)=>{"use strict";var n=r(8999);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},7334:(e,t,r)=>{Promise.resolve().then(r.bind(r,385))}},e=>{var t=t=>e(e.s=t);e.O(0,[9367,1831,8441,1684,7358],()=>t(7334)),_N_E=e.O()}]);